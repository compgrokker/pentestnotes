Exact Samba version:
nmap --script smb-os-discovery.nse -p 445 <ip>
metasploit:
use auxiliary/scanner/smb/smb_version
set RHOSTS

NetBIOS name of server:
nmap --script smb-os-discovery.nse -p 445 <ip>
nmblookup -A <ip>

check whether NULL session is allowed:
smbclient -L <ip> -N
rpcclient -U "" -N <ip>

find OS version via samba
rpcclient -U "" -N <ip>
	srvinfo
enum4linux -o <ip>

get server description
smbclient -L <ip> -N

supported protocols:
nmap -p445 --script smb-protocols <ip>
metasploit:
use auxiliary/scanner/smb/smb2
set RHOSTS

list users
nmap --script smb-enum-users.nse -p445 <ip>
metasploit:
use auxiliary/scanner/smb/smb_enumusers
set RHOSTS
enum4linux -U <ip>
rpcclient -U "" -N <ip>
	enumdomusers

find SID of user
rpcclient -U "" -N <ip>
	lookupnames <name>

enum4linux -r -u <user> -p <pass> <ip> (enumerate SIDs recursively)

list all available shares
nmap --script smb-enum-shares.nse -p445 <ip>
metasploit:
use auxiliary/scanner/smb/smb_enumshares
set RHOSTS
enum4linux -S <ip>
smbclient -L <ip> -N

find domain groups
enum4linux -G <ip>
rpcclient -U "" -N <ip>
	enumdomgroups

does samba server support printing?
enum4linux -i <ip>

list contents of share (or execute other commands in place of ls)
smbclient //<ip>/<share> -N
	ls

Samba dictionary attack
metasploit:
use auxiliary/scanner/smb/smb_login
set PASS_FILE /usr/share/wordlists/metasploit/unix_passwords.txt
set SMBUser <user>
set RHOSTS <ip>

hydra -l admin -P /usr/share/wordlists/rockyou.txt <ip> smb ^f99dff

list named pipes available via samba
metasploit:
use auxiliary/scanner/smb/pipe_auditor
set SMBUser <user>
set SMBPass <pass>
set RHOSTS <ip>

sudo nbtscan -r <ip>

