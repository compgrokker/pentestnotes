migrate meterpreter to lsass
`migrate -N lsass.exe`
`hashdump`
background meterpreter and check the creds got saved with `creds`
`use auxiliary/analyze/crack_windows`

## Snaffler
snaffler will search AD for creds (and other stuff)
https://github.com/SnaffCon/Snaffler
### What is it for?

[](https://github.com/SnaffCon/Snaffler#what-is-it-for)

Snaffler is a tool for **pentesters** and **red teamers** to help find delicious candy needles (creds mostly, but it's flexible) in a bunch of horrible boring haystacks (a massive Windows/AD environment).

It might also be useful for other people doing other stuff, but it is explicitly NOT meant to be an "audit" tool.

### I don't want to read all this!!!

[](https://github.com/SnaffCon/Snaffler#i-dont-want-to-read-all-this)

Ugh, fine. But we aren't responsible for the results. We wrote all this other stuff for you, but that's okay. We're not mad, just disappointed.

`snaffler.exe -s -o snaffler.log`

### What does it do?

[](https://github.com/SnaffCon/Snaffler#what-does-it-do)

_Broadly speaking_ - it gets a list of Windows computers from Active Directory, then spreads out its snaffly appendages to them all to figure out which ones have file shares, and whether you can read them.

Then YET MORE snaffly appendages enumerate all the files in those shares and use **L**EARNED **A**RTIFACTUAL **I**NTELLIGENCE for **M**ACHINES to figure out which ones a grubby little hacker like you might want.

Actually it doesn't do any ML stuff, because doing that right would require training data, and that would require an enormous amount of time that we don't have. Instead, like all good "ML" projects, it just uses a shitload of `if` statements and regexen.

## Manspider
[![Man-Spider](https://static.wikia.nocookie.net/villains/images/8/8f/Man-Spider.png/revision/latest/scale-to-width-down/350?cb=20140729015041)

](https://static.wikia.nocookie.net/villains/images/8/8f/Man-Spider.png/revision/latest?cb=20140729015041 "Man-Spider")
manspider to crawl SMB shares with a provided username
https://github.com/blacklanternsecurity/MANSPIDER
### Crawl SMB shares for juicy information. File content searching + regex is supported!

[](https://github.com/blacklanternsecurity/MANSPIDER#crawl-smb-shares-for-juicy-information-file-content-searching--regex-is-supported)

### UPDATE 2023-10-15

[](https://github.com/blacklanternsecurity/MANSPIDER#update-2023-10-15)

**[textract](https://github.com/deanmalmgren/textract), one of manspider's upstream dependencies, is no longer being updated. For this reason, you may run into problems when installing with pip. The recommended installation method is now [Docker](https://hub.docker.com/r/blacklanternsecurity/manspider):**

```shell
docker run --rm -v ./manspider:/root/.manspider blacklanternsecurity/manspider --help
```

Note there is also a helper script `manspider.sh` which will automatically mount volumes for manspider's `loot` and `logs` directories, making it a bit more convenient to run:

```shell
./manspider.sh --help
```

[![manspider](https://user-images.githubusercontent.com/20261699/74963251-6a08de80-53df-11ea-88f4-60c39665dfa2.gif)](https://user-images.githubusercontent.com/20261699/74963251-6a08de80-53df-11ea-88f4-60c39665dfa2.gif)

### File types supported:

[](https://github.com/blacklanternsecurity/MANSPIDER#file-types-supported)

- `PDF`
- `DOCX`
- `XLSX`
- `PPTX`
- any text-based format
- and many more!!

### MANSPIDER will crawl every share on every target system. If provided creds don't work, it will fall back to "guest", then to a null session.